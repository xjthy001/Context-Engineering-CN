# 预算模型:资源管理心智模型

## 简介

预算模型将上下文工程视为资源管理的实践。就像管理财务预算一样,您有有限的资源(Token、注意力、计算)需要在各种需求中进行分配。该模型帮助您做出战略性权衡并优化资源利用。

**核心隐喻**: 上下文工程就像管理预算——明智地分配有限资源以最大化价值。

## 预算类别

### 1. Token预算(主要货币)

```
可用Token
├── 输入预算(提示)
│   ├── 系统指令
│   ├── 上下文信息
│   ├── 用户请求
│   └── 示例
└── 输出预算(响应)
    ├── 主要内容
    ├── 解释
    └── 格式化开销
```

**分配原则**:
- **必需开支**(40-50%): 核心指令和基本上下文
- **可变开支**(30-40%): 可扩展的上下文和示例
- **储备基金**(10-20%): 输出空间和意外情况

### 2. 注意力预算(感知货币)

```
注意力容量
├── 优先级1: 必须关注的内容
├── 优先级2: 应该关注的内容
├── 优先级3: 可以关注的内容
└── 未读: 可能忽略的内容
```

**分配策略**:
- **关键信息**: 放在前面,清晰结构化
- **支持细节**: 分层呈现
- **可选内容**: 明确标记为可选

### 3. 计算预算(处理货币)

```
计算资源
├── 理解成本
├── 推理成本
├── 生成成本
└── 验证成本
```

## 预算编制策略

### 策略1: 零基预算

从零开始,证明每一项Token的必要性。

```markdown
## 零基预算模板

### 绝对必需项
- [ ] 项目描述: _____ (Token: ~___)
- [ ] 核心指令: _____ (Token: ~___)

### 论证必要性
- [ ] 项目描述: _____ (Token: ~___)
  理由: _____

### 可选项(如有预算)
- [ ] 项目描述: _____ (Token: ~___)
```

### 策略2: 增量预算

基于先前成功的模式,逐步增加。

```markdown
## 增量预算

### 基准(上次运行)
- Token使用: ___
- 有效性: ___/10
- 成本: $___

### 本次调整
+ 增加: _____ (+___ Token)
- 移除: _____ (-___ Token)
= 净变化: +/- ___ Token

### 预期
- 新增Token使用: ___
- 预期改进: _____
```

### 策略3: 弹性预算

为不同场景准备多个预算级别。

```markdown
## 弹性预算层级

### 最小可行预算(紧急)
Token: 500-1000
内容: 仅核心指令
使用场景: 快速查询,明确的任务

### 标准预算(日常)
Token: 2000-4000
内容: 指令 + 必要上下文 + 示例
使用场景: 常规任务

### 增强预算(复杂)
Token: 8000-16000
内容: 全面上下文 + 多个示例 + 背景
使用场景: 复杂问题,细微决策

### 最大预算(关键)
Token: 32000+
内容: 完整上下文 + 所有相关信息
使用场景: 关键决策,完整性至关重要
```

## 预算优化技术

### 1. 压缩技术

**总结**:
```
原始(1000 Token):
[详细的背景文档]

压缩后(100 Token):
关键要点:
- 要点1
- 要点2
- 要点3
```

**引用**:
```
不是包含完整文档(5000 Token):
而是引用: "见第3.2节的文档X" (10 Token)
```

**分块**:
```
不是一次性包含全部内容:
"我将分3部分发送上下文。这是第1部分..."
```

### 2. 按需分配

```markdown
## 按需模式

### 初始请求(精简)
[最小上下文]

### 根据响应
如果需要更多上下文:
  → 提供额外细节
否则:
  → 继续使用精简上下文
```

### 3. 投资回报率分析

```markdown
## 上下文ROI评估

上下文项: _____
Token成本: _____
预期改进: _____
ROI: [低/中/高]

保留还是剪切? _____
理由: _____
```

## 预算模式

### 模式1: 前置投资

在前面投入更多资源以获得清晰度。

```
分配:
██████████░░░░░░ 指令(60%)
████░░░░░░░░░░░░ 上下文(25%)
██░░░░░░░░░░░░░░ 输出空间(15%)

适用于:
- 复杂任务
- 首次尝试
- 需要精确性
```

### 模式2: 平衡分配

在各方面平均分配。

```
分配:
██████░░░░░░░░░░ 指令(40%)
██████░░░░░░░░░░ 上下文(40%)
███░░░░░░░░░░░░░ 输出空间(20%)

适用于:
- 标准任务
- 成熟的工作流程
- 适度复杂性
```

### 模式3: 输出优先

最小化输入,最大化输出空间。

```
分配:
████░░░░░░░░░░░░ 指令(25%)
███░░░░░░░░░░░░░ 上下文(20%)
█████████░░░░░░░ 输出空间(55%)

适用于:
- 生成任务
- 已建立上下文
- 长篇输出
```

## 预算危机管理

### 危机1: 预算超支

**症状**: Token限制错误,被截断的上下文

**解决方案**:
1. **紧急削减**:
   ```markdown
   优先级系统:
   P0: 绝对必需 → 保留
   P1: 非常重要 → 可能总结
   P2: 有帮助 → 考虑剪切
   P3: 锦上添花 → 立即剪切
   ```

2. **重组**:
   ```markdown
   将单一大型提示改为:
   → 一系列较小的聚焦提示
   → 每个都在预算范围内
   ```

3. **外部化**:
   ```markdown
   将大型资产移至外部:
   → 文件
   → 工具
   → 检索系统
   ```

### 危机2: 预算不足

**症状**: 响应差强人意,缺少上下文

**解决方案**:
1. **审计**:
   ```markdown
   检查未充分利用的资源:
   - 未使用的示例?
   - 过于简略的指令?
   - 缺少关键上下文?
   ```

2. **战略性增加**:
   ```markdown
   投资于:
   - 清晰度(更好的指令)
   - 示例(展示所需内容)
   - 上下文(关键背景)
   ```

## 预算审计流程

```markdown
## 月度上下文审计

### 1. 使用审查
- 平均Token/请求: _____
- 峰值使用: _____
- 最小使用: _____

### 2. 效率分析
- 每Token的价值: _____
- 浪费区域: _____
- 优化机会: _____

### 3. 模式识别
- 高成本模式: _____
- 低成本模式: _____
- 最佳实践: _____

### 4. 行动项
1. _____
2. _____
3. _____

### 5. 预算调整
新标准: _____
理由: _____
```

## 工具与计算器

### Token估算器

```
粗略Token估算:
- 英文: ~1个词 = ~1.3个Token
- 字符: ~1个字符 = ~0.25个Token
- 代码: ~1行 = ~4-6个Token

精确方法:
- 使用Token化工具
- Claude的Web界面显示计数
- API响应包含使用统计
```

### 成本计算器

```markdown
## 提示成本计算

输入Token: _____
输出Token: _____

成本(当前费率):
- 输入: _____ × $___/百万Token = $_____
- 输出: _____ × $___/百万Token = $_____
- 总计: $_____

月度预估(30天):
- 使用频率/天: _____
- 月度成本: $_____
```

## 高级预算概念

### 1. 预算套利

利用不同方法之间的效率差异。

```markdown
示例:
代替: 在提示中包含整个代码库(昂贵)
使用: 分析工具工具访问代码(更便宜)
节省: ~90% Token
```

### 2. 预算组合

平衡不同类型的"支出"以获得最佳结果。

```
投资组合:
30% - 高质量指令
30% - 精选示例
20% - 必要上下文
20% - 输出空间
```

### 3. 预算对冲

为不确定性做准备。

```markdown
主要预算: 标准情况
对冲预算: 复杂情况
备用基金: 意外需求
```

## 实际练习

### 练习1: 预算审计

审计您的一个现有提示:

```markdown
## 我的提示审计

提示总Token: _____

分解:
- 系统消息: _____ (_____%)
- 指令: _____ (_____%)
- 上下文: _____ (_____%)
- 示例: _____ (_____%)
- 其他: _____ (_____%)

削减机会:
1. _____
2. _____
3. _____

潜在节省: _____ Token (_____%)
```

### 练习2: 预算重新分配

优化一个低效的提示:

```markdown
## 预算重新分配

原始:
- 冗长解释: 1000 Token
- 单一示例: 200 Token
- 模糊指令: 50 Token

优化后:
- 精炼解释: 300 Token
- 三个示例: 600 Token
- 清晰指令: 150 Token

结果:
- Token变化: 1250 → 1050 (-200)
- 预期影响: [更好/相同/更差]
```

### 练习3: 弹性预算设计

为一个任务创建多层级预算:

```markdown
## 任务: _____

### 紧急预算(500 Token)
包含: _____
何时使用: _____

### 标准预算(2000 Token)
包含: _____
何时使用: _____

### 高级预算(8000 Token)
包含: _____
何时使用: _____
```

## 财务顾问心态

像好的财务顾问一样思考:

1. **追踪一切**: 监控您的Token使用
2. **识别模式**: 注意什么昂贵,什么便宜
3. **优化不断**: 始终寻找效率
4. **战略性投资**: 在重要的地方花费
5. **维持储备**: 为意外情况保留空间
6. **寻求ROI**: 衡量您的支出价值
7. **适应性强**: 根据需要调整预算
8. **保持节俭**: 尊重稀缺性

## 预算谚语

> "Token节省即Token获得"

> "先计划预算,然后按预算计划"

> "在提示中包含的每个词必须证明其存在的Token"

> "最好的优化是消除不必要的开支"

> "过早的Token使用是所有优化之根"

## 与其他模型的集成

**与园丁模型**:
- 预算 → 限制您的"花园"大小
- 资源 → 确定您可以种植什么

**与河流模型**:
- Token → 流经系统的"水"
- 预算 → 可用流量

**与炼金术模型**:
- Token → 转化过程的"燃料"
- 预算 → 能量投资

## 结论

预算模型在上下文工程中引入经济思维。通过将Token视为您必须明智投资的有限资源,您可以做出更好的权衡决策并实现更高的效率。

记住: 在上下文工程中,约束不是限制——它们是创造力的催化剂。预算迫使您澄清什么真正重要并找到优雅的解决方案。

**关键要点**:
- Token是一种应该尊重的有限资源
- 战略性预算编制提高效率和有效性
- 不同任务需要不同的预算分配
- 持续审计和优化是必不可少的
- 约束激发更好的解决方案

---

*"在限制中,大师展现自己。" - 歌德*